I think it's possible it could be written on the fly. The story gives the appearance of vast scope because the storylines are from different eras and areas, but rather than a broad panorama, it only provides thin slivers of insight into each time and place. Everything in between these slivers is left to the player's imagination. And given the author's hints at branching timelines, he or she is not even necessarily required to link these little slivers together.

People also point to the various stories' interconnectedness and claim that the work has a structure too intricate to be improvisational, but how much interconnectedness is there really? For example, the stone age story has cats in it, and the cat story has cats in it (obviously). This is a point of similarity (obviously). But what is the significance? So what if both stories have cats? Is this meaningful coincidence or a meaningless one? 

The same question could be asked about the children of the forest or the various Marines or the demon penises for which the author has such fondness. Yes, these elements recur, but to what end? Perhaps, like somebody on LSD undergoing a false revelation, we are drawing connections where none really exist. Perhaps these are meaningless coincidences.

The story employs a number of "call backs" where it makes reference to something which was not mentioned in quite a while. This gives the appearance of careful preplanning. But call backs are actually a pretty easy to improvise. The author can just look over the story, pick an element, and bring it to the fore again. Like a prime factorization problem, the problem is easier to create than it is to solve. A successful callback is really more of a testament to the reader's intelligence than the author's.

And btw, whatever happened to COMPANION-12? That seemed like it was going to be a thing.

But anyways, all this is speculation on my part. It's an interesting question: how can we know whether the story is improvised or not? The author does occasionally make direct responses to other Reddit comments and make reference to current events, but as you said this could just be a sort of superficial improvisation, where most of the story is actually fixed, but a few of the details are improvised. The author could also be combing through reddit for the right comment to give the appearance of improvisation.

Are we watching real choices in action, or are the events of this universe occurring along some deterministic path? Is there any way to find out? Maybe some sort of test should be devised. But that would require the author to play along.
